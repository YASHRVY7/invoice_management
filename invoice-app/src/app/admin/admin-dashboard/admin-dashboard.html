<div class="min-h-screen bg-gray-50 px-4 py-12 text-gray-900 sm:px-6 lg:px-8">
    <div class="mx-auto max-w-6xl space-y-10">
      <header class="flex flex-col gap-4 rounded-3xl border border-gray-200 bg-gradient-to-br from-white to-gray-50 p-8 shadow-2xl backdrop-blur">
        <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
          <div>
            <p class="text-xs font-bold uppercase tracking-[0.4em] text-gray-600">Control Center</p>
            <h1 class="text-4xl font-bold text-gray-900">Admin Dashboard</h1>
            <p class="mt-2 text-gray-600 font-medium">Monitor user activity, roles and recent audit logs.</p>
          </div>
          <div class="flex items-center gap-3">
            <p class="text-sm text-gray-600 font-medium" *ngIf="lastUpdated">Updated {{ lastUpdated | date:'MMM d, h:mm a' }}</p>
            <button (click)="refresh()" class="inline-flex items-center gap-2 rounded-full border border-gray-300 bg-gray-900 hover:bg-black px-5 py-2.5 text-sm font-semibold text-white transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
              <span class="h-2 w-2 animate-pulse rounded-full bg-green-400"></span>
              Refresh data
            </button>
          </div>
        </div>
      </header>
  
      <section class="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <article class="rounded-2xl border border-gray-200 bg-gradient-to-br from-gray-50 to-white p-6 shadow-lg hover:shadow-xl transition-shadow">
          <p class="text-sm uppercase tracking-wide text-gray-600 font-bold">Total Users</p>
          <p class="mt-3 text-4xl font-bold text-gray-900">{{ loadingUsers ? '—' : totalUsers }}</p>
          <p class="mt-2 text-xs text-gray-600 font-medium">All registered accounts</p>
        </article>
        <article class="rounded-2xl border border-green-200 bg-gradient-to-br from-green-50 to-white p-6 shadow-lg hover:shadow-xl transition-shadow">
          <p class="text-sm uppercase tracking-wide text-green-700 font-bold">Active Users</p>
          <p class="mt-3 text-4xl font-bold text-green-600">{{ loadingUsers ? '—' : activeUsers }}</p>
          <p class="mt-2 text-xs text-gray-600 font-medium">Currently enabled profiles</p>
        </article>
        <article class="rounded-2xl border border-gray-300 bg-gradient-to-br from-gray-100 to-white p-6 shadow-lg hover:shadow-xl transition-shadow">
          <p class="text-sm uppercase tracking-wide text-gray-800 font-bold">Admin Team</p>
          <p class="mt-3 text-4xl font-bold text-gray-900">{{ loadingUsers ? '—' : adminUsers }}</p>
          <p class="mt-2 text-xs text-gray-600 font-medium">Users with elevated access</p>
        </article>
        <article class="rounded-2xl border border-amber-200 bg-gradient-to-br from-amber-50 to-white p-6 shadow-lg hover:shadow-xl transition-shadow">
          <p class="text-sm uppercase tracking-wide text-amber-700 font-bold">Log Entries</p>
          <p class="mt-3 text-4xl font-bold text-amber-600">{{ loadingLogs ? '—' : logs.length }}</p>
          <p class="mt-2 text-xs text-gray-600 font-medium">Tracked administrative events</p>
        </article>
      </section>
  
      <section class="grid gap-6 lg:grid-cols-3">
        <div class="space-y-4 rounded-3xl border border-gray-200 bg-white p-6 shadow-2xl lg:col-span-2">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-bold uppercase tracking-wide text-gray-900">Users</p>
              <p class="text-xs text-gray-600 font-medium">Total {{ totalUsers }}</p>
            </div>
            <span class="rounded-full bg-gray-100 border border-gray-200 px-3 py-1 text-xs font-semibold text-gray-700">{{ users.length }} results</span>
          </div>
  
          <div class="overflow-hidden rounded-2xl border border-gray-200">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50 text-left text-xs font-bold uppercase tracking-wider text-gray-700">
                <tr>
                  <th class="px-4 py-3">User</th>
                  <th class="px-4 py-3">Email</th>
                  <th class="px-4 py-3">Role</th>
                  <th class="px-4 py-3 text-center">Status</th>
                  <th class="px-4 py-3 text-right">Actions</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-100 text-sm bg-white" *ngIf="!loadingUsers && users.length">
                <tr class="transition hover:bg-gray-50" *ngFor="let user of users; trackBy: trackByUserId">
                  <td class="px-4 py-4">
                    <div class="font-bold text-gray-900">{{ user.username }}</div>
                    <div class="text-xs text-gray-500 font-medium">#{{ user.id }}</div>
                  </td>
                  <td class="px-4 py-4 text-gray-700 font-medium">{{ user.email }}</td>
                  <td class="px-4 py-4">
                    <span class="rounded-full bg-gray-100 border border-gray-200 px-3 py-1 text-xs font-semibold capitalize text-gray-800">{{ user.role }}</span>
                  </td>
                  <td class="px-4 py-4 text-center">
                    <span [ngClass]="user.isActive ? 'bg-green-100 text-green-700 border-green-200' : 'bg-red-100 text-red-700 border-red-200'" class="rounded-full px-3 py-1 text-xs font-semibold border">
                      {{ user.isActive ? 'Active' : 'Disabled' }}
                    </span>
                  </td>
                  <td class="px-4 py-4 text-right">
                    <button
                      class="inline-flex items-center gap-2 rounded-full border border-gray-300 px-4 py-2 text-xs font-semibold text-gray-700 transition hover:border-red-300 hover:bg-red-50 hover:text-red-700 disabled:cursor-not-allowed disabled:border-gray-200 disabled:bg-gray-100 disabled:text-gray-400"
                      (click)="deleteUser(user.id)"
                      [disabled]="removingUserId === user.id"
                    >
                      <span *ngIf="removingUserId === user.id" class="inline-flex items-center gap-2">
                        <span class="h-2 w-2 animate-spin rounded-full border-2 border-gray-400 border-t-transparent"></span>
                        Removing…
                      </span>
                      <span *ngIf="removingUserId !== user.id">Remove</span>
                    </button>
                  </td>
                </tr>
              </tbody>
              <tbody *ngIf="loadingUsers">
                <tr>
                  <td colspan="5" class="px-4 py-10 text-center text-gray-500">
                    <div class="flex flex-col items-center justify-center gap-3">
                      <div class="animate-spin rounded-full h-8 w-8 border-4 border-gray-200 border-t-gray-900"></div>
                      <p class="font-medium">Loading user insights…</p>
                    </div>
                  </td>
                </tr>
              </tbody>
              <tbody *ngIf="!loadingUsers && !users.length">
                <tr>
                  <td colspan="5" class="px-4 py-10 text-center text-gray-500 font-medium">No users found.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
  
        <div class="space-y-4 rounded-3xl border border-gray-200 bg-white p-6 shadow-2xl">
          <div>
            <p class="text-sm font-bold uppercase tracking-wide text-gray-900">Audit Log</p>
            <p class="text-xs text-gray-600 font-medium">Recent administrative events</p>
          </div>
  
          <div class="space-y-3" *ngIf="!loadingLogs && logs.length">
            <div class="flex gap-4 rounded-2xl border border-gray-200 bg-gray-50 p-4 shadow-sm hover:shadow-md transition-shadow" *ngFor="let log of logs; trackBy: trackByLog">
              <div class="mt-1 h-3 w-3 rounded-full bg-amber-400 flex-shrink-0"></div>
              <div class="flex-1">
                <p class="text-sm font-bold text-gray-900">{{ log.action }}</p>
                <p class="text-xs text-gray-600 font-medium">by <span class="font-semibold text-gray-900">{{ log.user }}</span></p>
                <p class="text-xs text-gray-500 font-medium">{{ log.date | date:'MMM d, h:mm a' }}</p>
              </div>
            </div>
          </div>
  
          <div class="rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-8 text-center text-sm text-gray-500 font-medium" *ngIf="loadingLogs">
            <div class="flex flex-col items-center gap-3">
              <div class="animate-spin rounded-full h-8 w-8 border-4 border-gray-200 border-t-gray-900"></div>
              <p>Loading logs…</p>
            </div>
          </div>
          <div class="rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-8 text-center text-sm text-gray-500 font-medium" *ngIf="!loadingLogs && !logs.length">
            No audit events recorded yet.
          </div>
        </div>
      </section>
    </div>
  </div>